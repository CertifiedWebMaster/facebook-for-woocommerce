"use strict";jQuery(document).ready(function(s){var t,e,c,n,d,o,_,a,r,i,l,u,p,f,g,m,b,h=window.pagenow.length?window.pagenow:"";window.typenow.length&&window.typenow;"edit-product"===h&&(t=!1,s("input#doaction, input#doaction2").on("click",function(o){if(t)return!0;o.preventDefault();var e,c=s(this),o=c.prev("select").val();"facebook_include"===o?(e=[],s.each(s('input[name="post[]"]:checked'),function(){e.push(parseInt(s(this).val(),10))}),s.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_bulk_action_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_bulk_action_prompt_nonce,toggle:o,products:e},function(o){o&&!o.success?(s("#wc-backbone-modal-dialog .modal-close").trigger("click"),new s.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:o.data})):(t=!0,c.trigger("click"))})):(t=!0,c.trigger("click"))})),"product"===h&&(e=function(o,e){e.find(".enable-if-sync-enabled").prop("disabled",!o)},c=function(o,e){o?(e.find("option[value='sync_and_show']").show(),e.prop("original")&&e.val(e.prop("original"))):(e.find("option[value='sync_and_show']").hide(),"sync_and_show"===e.val()&&e.val("sync_and_hide"))},n=function(o,e){var c=e.find("#wc_facebook_commerce_enabled"),t=c.prop("original");c.prop("checked",!!o&&t).prop("disabled",!o),c.trigger("change"),c.prop("original",t),e.find("#product-not-ready-notice, #variable-product-not-ready-notice").hide(),i()&&!_()?e.find("#variable-product-not-ready-notice").show():o||e.find("#product-not-ready-notice").show()},d=function(){return!!o()&&(!!r()&&!!u())},o=function(){return(i()?_:a)()},_=function(){var o=s(".js-variable-fb-sync-toggle");return 0===o.length?!!facebook_for_woocommerce_products_admin.is_sync_enabled_for_product:!!o.map(function(o,e){return"sync_disabled"!==s(e).val()?e:null}).length},a=function(){return"sync_disabled"!==f.val()},r=function(){return!!i()||l()},i=function(){var o=s("select#product-type").val();return!(!o||!o.match(/variable/))},l=function(){return!(!s("#_regular_price").val()&&!s("#fb_product_price").val())},u=function(){return p()},p=function(){return!(!s("#_manage_stock").prop("checked")||!s("#_stock").val())},s("#facebook_options #wc_facebook_commerce_enabled").on("change",function(){var o=s(this).prop("checked");o?s(".wc_facebook_commerce_fields").show():s(".wc_facebook_commerce_fields").hide(),s(".product_attributes").find(".woocommerce_attribute").length?s(".show_if_has_attributes").show():s(".show_if_has_attributes").hide(),s(this).prop("original",o)}).trigger("change"),f=s("#wc_facebook_sync_mode"),g=f.closest(".woocommerce_options_panel"),(b=f).attr("data-original-value",b.val()),f.on("change",function(){var o="sync_disabled"!==s(this).val();e(o,g),function(o,e){e=e.find(".wc-facebook-commerce-options-group");o?e.show():e.hide()}(o,g),f.prop("original",s(this).val())}).trigger("change"),s("#_virtual").on("change",function(){c(!s(this).prop("checked"),f)}).trigger("change"),(h=s("#woocommerce-product-data")).on("change","#_regular_price, #_manage_stock, #_stock, #wc_facebook_sync_mode, #fb_product_price",function(o){setTimeout(function(){n(d(),s("#facebook_options"))},1)}),s(".woocommerce_variations").on("change",".js-variable-fb-sync-toggle",function(){e("sync_disabled"!==s(this).val(),s(this).closest(".wc-metabox-content")),n(d(),s("#facebook_options")),s(this).prop("original",s(this).val())}),h.on("woocommerce_variations_loaded",function(){s(".js-variable-fb-sync-toggle").each(function(){e("sync_disabled"!==s(this).val(),s(this).closest(".wc-metabox-content")),s(this).prop("original",s(this).val())}),s(".variable_is_virtual").on("change",function(){var o=s(this).closest(".wc-metabox-content").find(".js-variable-fb-sync-toggle");c(!s(this).prop("checked"),o)}),n(d(),s("#facebook_options"))}),h.on("change",".js-fb-product-image-source",function(){var o=s(this).closest(".woocommerce_options_panel, .wc-metabox-content"),e=s(this).val();o.find(".product-image-source-field").closest(".form-field").hide(),o.find(".show-if-product-image-source-"+e).closest(".form-field").show()}),s(".js-fb-product-image-source:checked:visible").trigger("change"),h.on("woocommerce_variations_loaded",function(){s(".js-variable-fb-sync-toggle:visible").trigger("change"),s(".js-fb-product-image-source:checked:visible").trigger("change"),s(".variable_is_virtual:visible").trigger("change")}),s("#facebook_options").on("click","#product-not-ready-notice-open-modal",function(o){o.preventDefault(),s("#wc-backbone-modal-dialog .modal-close").trigger("click"),new s.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:{message:facebook_for_woocommerce_products_admin.product_not_ready_modal_message,buttons:facebook_for_woocommerce_products_admin.product_not_ready_modal_buttons}})}),n(d(),g),m=!1,s('form#post input[type="submit"]').on("click",function(o){if(!!s("#wc_facebook_commerce_enabled").prop("checked")&&(!!d()&&s(".wc_facebook_commerce_fields .wc-facebook-google-product-category-select").map(function(o,e){return s(e).val()?s(e).val():null}).length<2))return o.preventDefault(),alert(facebook_for_woocommerce_products_admin.i18n.missing_google_product_category_message),!1;if(m)return!0;o.preventDefault();var e,c=s(this),t=parseInt(s("input#post_ID").val(),10),n=[],a=s('textarea[name="tax_input[product_tag]"]').length?s('textarea[name="tax_input[product_tag]"]').val().split(","):[],r="sync_disabled"!==f.val(),i=_();if("sync_disabled"===(o=(e=f).val())&&o!==e.attr("data-original-value"))return console.log("display modal"),!1;s('#taxonomy-product_cat input[name="tax_input[product_cat][]"]:checked').each(function(){n.push(parseInt(s(this).val(),10))}),s('#taxonomy-product_tag input[name="tax_input[product_tag][]"]:checked').each(function(){a.push(parseInt(s(this).val(),10))}),0<t?s.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_prompt_nonce,sync_enabled:r?"enabled":"disabled",var_sync_enabled:i?"enabled":"disabled",product:t,categories:n,tags:a},function(o){o&&!o.success&&r?(s("#wc-backbone-modal-dialog .modal-close").trigger("click"),new s.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:o.data})):(m=!0,c.trigger("click"))}):(m=!0,c.trigger("click"))}))});
//# sourceMappingURL=facebook-for-woocommerce-products-admin.min.js.map
